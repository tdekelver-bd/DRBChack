i <<- 1
while(i !=0){
cat("a")
if(sum(!is.na(x[i,])) < ncol(x)){
cat("b")
tmp <- list()
tmp[[i]] <- as.character(x[i,1])
i <<- i+1
} else{
cat("c")
colnames(x) <- as.character(x[i,])
x <- x[-c(1:i),]
x <- remove_n(x=x)
tmp[[i]] <- x
i <<- 0
}
}
x <- tmp
}
return(x)
}
test2 <- title(x=tbls2[[2]])
test2
test2 <- title(x=tbls2[[3]])
test2
title <- function(x){
if(ncol(x)==1 & nrow(x)==1){
x <- remove_n(x=x)
if(length(x)==1){
x <- list(x[1,])
}else{
x <- list(x[1,],as.vector(x[-1,]))
}
}else if(ncol(x)==1 & nrow(x)>1){
x <- list(x[1,1], x[-1,])
x <- remove_n(x=x[[2]])
} else if(ncol(x)>1 & nrow(x>1)){
i <<- 1
while(i !=0){
cat("a")
if(sum(!is.na(x[i,])) < ncol(x)){
cat("b")
tmp <- list()
tmp[[i]] <- as.character(x[i,1])
i <<- i+1
} else{
cat("c")
colnames(x) <- as.character(x[i,])
x <- x[-c(1:i),]
x <- remove_n(x=x)
tmp[[i]] <- x
i <<- 0
}
}
x <- tmp
}
return(x)
}
test2 <- title(x=tbls2[[3]])
test2
title <- function(x){
if(ncol(x)==1 & nrow(x)==1){
x <- remove_n(x=x)
if(length(x)==1){
x <- list(as.character(x[1,]))
}else{
x <- list(as.character(x[1,]),as.vector(x[-1,]))
}
}else if(ncol(x)==1 & nrow(x)>1){
x <- list(x[1,1], x[-1,])
x <- remove_n(x=x[[2]])
} else if(ncol(x)>1 & nrow(x>1)){
i <<- 1
while(i !=0){
cat("a")
if(sum(!is.na(x[i,])) < ncol(x)){
cat("b")
tmp <- list()
tmp[[i]] <- as.character(x[i,1])
i <<- i+1
} else{
cat("c")
colnames(x) <- as.character(x[i,])
x <- x[-c(1:i),]
x <- remove_n(x=x)
tmp[[i]] <- x
i <<- 0
}
}
x <- tmp
}
return(x)
}
title(x=tbls2[[3]])
title(x=tbls2[[4]])
tbls2[[4]]
x=tbls2[[4]]
ncol(x)==1 & nrow(x)==1
x <- remove_n(x=x)
length(x)==1
x
class(x)
length(x)==1
x
nrow(as.data.frame(x))==1
title <- function(x){
if(ncol(x)==1 & nrow(x)==1){
x <- remove_n(x=x)
if(nrow(as.data.frame(x))==1){
x <- list(as.character(x[1,]))
}else{
x <- list(as.character(x[1,]),as.vector(x[-1,]))
}
}else if(ncol(x)==1 & nrow(x)>1){
x <- list(x[1,1], x[-1,])
x <- remove_n(x=x[[2]])
} else if(ncol(x)>1 & nrow(x>1)){
i <<- 1
while(i !=0){
cat("a")
if(sum(!is.na(x[i,])) < ncol(x)){
cat("b")
tmp <- list()
tmp[[i]] <- as.character(x[i,1])
i <<- i+1
} else{
cat("c")
colnames(x) <- as.character(x[i,])
x <- x[-c(1:i),]
x <- remove_n(x=x)
tmp[[i]] <- x
i <<- 0
}
}
x <- tmp
}
return(x)
}
title(tbls2[[4]])
title(tbls2[[1]])
title(tbls2[[2]])
title(tbls2[[3]])
title(tbls2[[4]])
title(tbls2[[5]])
title(tbls2[[6]])
title(tbls2[[7]])
title(tbls2[[6]])
title(tbls2[[7]])
title(tbls2[[8]])
title(tbls2[[9]])
title(tbls2[[10]])
title(tbls2[[11]])
title(tbls2[[12]])
title(tbls2[[13]])
title(tbls2[[14]])
title(tbls2[[15]])
title(tbls2[[16]])
title(tbls2[[17]])
structure <- function(doc){
for(q in seq(length(doc))) {
tmpy[[q]] <- title(x=doc[[q]])
return(tmpy)
}
}
structure <- function(doc){
for(q in seq(length(doc))) {
tmpy[[q]] <- title(x=doc[[q]])
return(tmpy)
}
}
test <- structure(tbls2)
test
structure <- function(doc){
for(q in seq(length(doc))) {
tmpy[[q]] <- title(x=doc[[q]])
}
return(tmpy)
}
test <- structure(tbls2)
structure <- function(doc){
for(q in seq(length(doc))) {
tmpy[[q]] <- title(x=doc[[q]])
}
return(toJSON(tmpy))
}
jsonFile <- structure(tbls2)
memory.limit(size=56000)
memory.limit()
structure <- function(doc){
for(q in seq(length(doc))) {
tmpy[[q]] <- title(x=doc[[q]])
}
return(tmpy)
}
test <- structure(tbls2)
structure <- function(doc){
for(q in seq(length(doc))) {
tmpy[[q]] <- title(x=doc[[q]])
print(q)
}
return(tmpy)
}
test <- structure(tbls2)
tbls2[[20]]
title(tbls2[[20]])
title(tbls2[[20]])
title(tbls2[[20]])
title <- function(x){
if(ncol(x)==1 & nrow(x)==1){
x <- remove_n(x=x)
if(nrow(as.data.frame(x))==1){
x <- list(as.character(x[1,]))
}else{
x <- list(as.character(x[1,]),as.vector(x[-1,]))
}
}else if(ncol(x)==1 & nrow(x)>1){
x <- list(x[1,1], x[-1,])
x <- remove_n(x=x[[2]])
} else if(ncol(x)>1 & nrow(x>1)){
i <<- 1
while(i !=0){
cat("a")
if(sum(!is.na(x[i,])) < ncol(x)){
cat("b")
tmp <- list()
tmp[[i]] <- as.character(x[i,1])
i <<- i+1
} else{
cat("c")
colnames(x) <- as.character(x[i,])
x <- x[-c(1:i),]
if(nrow(as.data.frame(x))<10){
x <- remove_n(x=x)
} else{
x <- x
}
tmp[[i]] <- x
i <<- 0
}
}
x <- tmp
}
return(x)
}
structure <- function(doc){
for(q in seq(length(doc))) {
tmpy[[q]] <- title(x=doc[[q]])
print(q)
}
return(tmpy)
}
test <- structure(tbls2)
test
structure_all <- function(file){
txt <- docxtractr::read_docx(file)
tbls <- docx_extract_all_tbls(txt, preserve=T, guess_header = T)
tbls2 <- lapply(tbls, as.data.frame)
struct <- structure(tbls2)
return(struct)
}
structure_all("C:/Users/rbelhocine/Desktop/BD/Arcelor/Data/WorkInstructions/WID_78382.docx")
list.files("C:/Users/rbelhocine/Desktop/BD/Arcelor/Data/WorkInstructions/",pattern = ".docx$", recursive = TRUE)
list_files <- list.files("C:/Users/rbelhocine/Desktop/BD/Arcelor/Data/WorkInstructions/",pattern = ".docx$", recursive = TRUE)
list_files_ent <- paste("C:/Users/rbelhocine/Desktop/BD/Arcelor/Data/WorkInstructions/WID_78382.docx", list_files)
list_files_ent
list_files_ent <- paste("C:/Users/rbelhocine/Desktop/BD/Arcelor/Data/WorkInstructions/", list_files, sep="")
list_files_ent
entire_list <- lapply(list_files_ent, structure_all)
title <- function(x){
tryCatch({
if(ncol(x)==1 & nrow(x)==1){
x <- remove_n(x=x)
if(nrow(as.data.frame(x))==1){
x <- list(as.character(x[1,]))
}else{
x <- list(as.character(x[1,]),as.vector(x[-1,]))
}
}else if(ncol(x)==1 & nrow(x)>1){
x <- list(x[1,1], x[-1,])
x <- remove_n(x=x[[2]])
} else if(ncol(x)>1 & nrow(x>1)){
i <<- 1
while(i !=0){
cat("a")
if(sum(!is.na(x[i,])) < ncol(x)){
cat("b")
tmp <- list()
tmp[[i]] <- as.character(x[i,1])
i <<- i+1
} else{
cat("c")
colnames(x) <- as.character(x[i,])
x <- x[-c(1:i),]
if(nrow(as.data.frame(x))<10){
x <- remove_n(x=x)
} else{
x <- x
}
tmp[[i]] <- x
i <<- 0
}
}
x <- tmp
}
}, error=function(e){cat("ERROR :",conditionMessage(e), "\n")})
return(x)
}
structure_all <- function(file){
txt <- docxtractr::read_docx(file)
tbls <- docx_extract_all_tbls(txt, preserve=T, guess_header = T)
tbls2 <- lapply(tbls, as.data.frame)
struct <- structure(tbls2)
return(struct)
}
list_files <- list.files("C:/Users/rbelhocine/Desktop/BD/Arcelor/Data/WorkInstructions/",pattern = ".docx$", recursive = TRUE)
list_files_ent <- paste("C:/Users/rbelhocine/Desktop/BD/Arcelor/Data/WorkInstructions/", list_files, sep="")
entire_list <- lapply(list_files_ent, structure_all)
shiny::runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
install.packages("shinydashboardPlus")
install.packages("shinydashboardPlus")
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
entire_list <- lapply(list_files_ent[1:10], structure_all)
basename(list_files_ent)
structure_all <- function(file){
txt <- docxtractr::read_docx(file)
tbls <- docx_extract_all_tbls(txt, preserve=T, guess_header = T)
tbls2 <- lapply(tbls, as.data.frame)
struct <- structure(tbls2)
struct <- list(struct,as.character(basename(file)))
return(struct)
}
entire_list <- lapply(list_files_ent[1:10], structure_all)
entire_list
structure_all <- function(file){
txt <- docxtractr::read_docx(file)
tbls <- docx_extract_all_tbls(txt, preserve=T, guess_header = T)
tbls2 <- lapply(tbls, as.data.frame)
struct <- structure(tbls2)
struct <- list(as.character(basename(file),struct))
return(struct)
}
entire_list <- lapply(list_files_ent[1:10], structure_all)
entire_list
structure_all <- function(file){
txt <- docxtractr::read_docx(file)
tbls <- docx_extract_all_tbls(txt, preserve=T, guess_header = T)
tbls2 <- lapply(tbls, as.data.frame)
struct <- structure(tbls2)
struct <- list(as.character(basename(file)),struct)
return(struct)
}
source('C:/Users/rbelhocine/Desktop/BD/Arcelor/DataPrep.R')
title <- function(x){
tryCatch({
if(ncol(x)==1 & nrow(x)==1){
x <- remove_n(x=x)
if(nrow(as.data.frame(x))==1){
x <- list(as.character(x[1,]))
}else{
x <- list(as.character(x[1,]),as.vector(x[-1,]))
}
}else if(ncol(x)==1 & nrow(x)>1){
x <- list(x[1,1], x[-1,])
x <- remove_n(x=x[[2]])
} else if(ncol(x)>1 & nrow(x>1)){
i <<- 1
while(i !=0){
if(sum(!is.na(x[i,])) < ncol(x)){
tmp <- list()
tmp[[i]] <- as.character(x[i,1])
i <<- i+1
} else{
colnames(x) <- as.character(x[i,])
x <- x[-c(1:i),]
if(nrow(as.data.frame(x))<10){
x <- remove_n(x=x)
} else{
x <- x
}
tmp[[i]] <- x
i <<- 0
}
}
x <- tmp
}
}, error=function(e){cat("ERROR :",conditionMessage(e), "\n")})
return(x)
}
remove_n <- function(x){
lst_names <- c()
keys <- c()
if(is.null(nrow(x))){
for(j in seq(length(x))) {
assign(paste("lst",j,sep=""),sapply(x[j], str_split, "[\\n]"))
keys <- unlist(unique(c(keys,unique(names(get(paste("lst",j,sep="")))))))
lst_names <- c(lst_names,paste("lst",j,sep=""))
if(j==1){
conc <- setNames(get(paste("lst",j,sep="")), keys)
} else{
conc <- setNames(mapply(c, conc, get(lst_names[j])[keys]), keys)
}
}
} else {
for(j in seq(nrow(x))) {
assign(paste("lst",j,sep=""),sapply(x[j,], str_split, "[\\n]"))
keys <- unlist(unique(c(keys,unique(names(get(paste("lst",j,sep="")))))))
lst_names <- c(lst_names,paste("lst",j,sep=""))
if(j==1){
conc <- setNames(get(paste("lst",j,sep="")), keys)
} else{
conc <- setNames(mapply(c, conc, get(lst_names[j])[keys]), keys)
}
}
}
conc <- lapply(conc, `length<-`, max(lengths(conc)))
return(as.data.frame(conc))
}
structure_all <- function(file){
txt <- docxtractr::read_docx(file)
tbls <- docx_extract_all_tbls(txt, preserve=T, guess_header = T)
tbls2 <- lapply(tbls, as.data.frame)
struct <- structure(tbls2)
struct <- list(as.character(basename(file)),struct)
return(struct)
}
list_files <- list.files("C:/Users/rbelhocine/Desktop/BD/Arcelor/Data/WorkInstructions/",pattern = ".docx$", recursive = TRUE)
list_files_ent <- paste("C:/Users/rbelhocine/Desktop/BD/Arcelor/Data/WorkInstructions/", list_files, sep="")
entire_list <- lapply(list_files_ent[1:10], structure_all)
entire_list
entire_list[[1]][[1]]
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
runApp('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/Shiny_code')
getwd
getwd()
setwd('C:/Users/rbelhocine/Desktop/BD/Arcelor/R')
install.packages('rPython-win')
library(reticulate)
install.packages("reticulate")
library(reticulate)
source_python("Search_engine_and_topic_prediction.py")
a = Search_engine_and_topic_prediction('risk valve')
library(reticulate)
source_python("Search_engine_and_topic_prediction.py")
a = Search_engine_and_topic_prediction('risk valve')
setwd('C:/Users/rbelhocine/Desktop/BD/Arcelor/R/')
library(reticulate)
source_python("Search_engine_and_topic_prediction.py")
source_python("Search_engine_and_topic_prediction.py")
a = Search_engine_and_topic_prediction('risk valve')
a
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
a = Search_engine_and_topic_prediction('Responsibilities Lance car')
a = Search_engine_and_topic_prediction('Responsibilities Lance car')
a
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
as.data.frame(Search_engine_and_topic_prediction("risk valve")
)
runApp('Shiny_code')
tmp <- as.data.frame(Search_engine_and_topic_prediction("risk valve")[[2]])
tmp
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
entire_list[[]][[1]]=="WID_601380.docx"
list_files_ent
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
entire_list <- lapply(list_files_ent[32:38], structure_all)
entire_list <- lapply(list_files_ent[33:38], structure_all)
entire_list <- lapply(list_files_ent[1:10], structure_all)
test1
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
runApp('Shiny_code')
entire_list[[2]]
runApp('Shiny_code')
